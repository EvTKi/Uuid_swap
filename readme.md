# GUIDReplacer PySide6 Application

## Назначение

Интерфейс для замены GUID/UUID в CIM/XML-документах согласно маппингу из CSV-файла. Подсвечивает старые и новые идентификаторы, анализирует структуру XML (в том числе CIM-моделей с пространствами имён), поддерживает предпросмотр результатов, тёмную и светлую тему, поиск по тексту, дерево структуры документа.

---

## Возможности

- Загрузка XML- и CSV-файлов.
- Подсветка старых (`old_uid`, красный, зачёркнутый) и новых (`new_uid`, зелёный, сразу после старого) идентификаторов в предпросмотре.
- Замена всех GUID на новые, сохранение результата в отдельный файл.
- Переключение темы интерфейса (светлая/тёмная с серым фоном).
- **Дерево структуры XML**, учитывающее пространства имён (CIM, RDF и др.), отображает иерархию и основные идентификаторы.
- Поиск по предпросмотру (циклический) со жёлтой подсветкой совпадений.
- Горячие клавиши:  
    - `Ctrl+O` — выбрать XML  
    - `Ctrl+S` — заменить и сохранить  
    - `Ctrl+F` — поиск в предпросмотре
- Полная совместимость с CIM-моделями, RDF/XML.

---

## Структура проекта
project_folder/
main_ui.py # Графический интерфейс на PySide6 (основной файл)
backend.py # Функции загрузки и обработки данных (логика)
README.md # (этот файл)

---

## Установка

Требуется Python (рекомендуется 3.8+) и PySide6:
```
pip install PySide6
```

---

## Использование

1. **Запуск:**
    ```
    python main_ui.py
    ```
2. Выберите XML-файл (обычно экспорт CIM/RDF из вашей системы).
3. Выберите CSV-файл соответствий с колонками `old_uid;new_uid`.
4. Результаты будут сразу отображены с подсветкой и в предпросмотре.
5. Для замены нажмите кнопку "Выполнить замену" — результат сохранится рядом (`filename_output.xml`).

---

## Описание основных компонентов

- **XML-дерево:**  
    Дерево слева показывает структуру документа с учётом namespace и id. Клик по элементу выделяет его представление в исходном тексте.
- **Предпросмотр:**  
    Основное поле справа. Старые GUID красные и зачёркнутые, новые — зелёные в скобках.
- **Поиск по тексту:**  
    Строка поиска над предпросмотром, поддерживает горячую клавишу Ctrl+F и циклическую навигацию по совпадениям.
- **Темы интерфейса:**  
    Светлая и тёмная тема (на сером фоне).  
- **Логика работы:**  
    - Все данные обрабатываются через функции backend.py
    - Подсветка сделана средствами QTextEdit (форматы цвет/зачёркивание не сбрасываются при поиске).
    - Для CIM-XML корректно парсятся namespace и атрибуты rdf:about/resource.

---

## Пример CSV-файла
| old_uid                              | new_uid                              |
| ------------------------------------ | ------------------------------------ |
| 0d499bd5-9c92-4098-9247-3bd2f3414f75 | 1d499bd5-9c92-4098-9247-3bd2f3414f75 |
| 9343ae51-bd26-4732-9d8b-4ff5bef8b7f0 | NEW-GUID-2                           |

---

## Ограничения и примечания

- Для крупных CIM XML (десятки мегабайт): возможна задержка при построении дерева структуры.
- Нестандартные или некорректные XML сами отмечаются в дереве ошибкой.
- Если структура необычно вложена — используйте актуальный код с циклическим стеком (см. функцию build_xml_tree_with_ns).

---

## Разработчик и поддержка

- Любой вопрос/доработку кода можете задать по месту использования или через GitHub Issues (если выложите проект).  
- @ваш_ник (замените, если выкладываете публично)

---
